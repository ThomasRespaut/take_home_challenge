{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-11-18T14:13:10.354249Z", "invocation_id": "b06a869b-8a2d-4eee-8ee1-a9985fc24436", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T14:13:08.145482Z", "completed_at": "2024-11-18T14:13:08.154950Z"}, {"name": "execute", "started_at": "2024-11-18T14:13:08.186288Z", "completed_at": "2024-11-18T14:13:09.215228Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0807430744171143, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "takehomechallenge", "job_id": "1cc01543-1fc2-45d3-9b1a-79b5b9fc3d18", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.take_home_challenge.order_segmentation", "compiled": true, "compiled_code": "WITH order_counts AS (\r\n    SELECT\r\n        o.orders_id,\r\n        o.customers_id AS client_id,\r\n        o.date_date AS order_date,\r\n        COUNT(*) OVER (\r\n            PARTITION BY o.customers_id\r\n            ORDER BY o.date_date\r\n            ROWS BETWEEN 12 PRECEDING AND CURRENT ROW\r\n        ) AS orders_in_last_12_months\r\n    FROM\r\n        takehomechallenge.orders_recrutement.orders o\r\n    WHERE\r\n        EXTRACT(YEAR FROM o.date_date) = 2023\r\n)\r\nSELECT\r\n    o.orders_id,\r\n    o.client_id,\r\n    o.order_date,\r\n    CASE\r\n        WHEN o.orders_in_last_12_months = 1 THEN 'New'\r\n        WHEN o.orders_in_last_12_months BETWEEN 2 AND 4 THEN 'Returning'\r\n        WHEN o.orders_in_last_12_months >= 5 THEN 'VIP'\r\n        ELSE 'Unknown'\r\n    END AS order_segment\r\nFROM\r\n    order_counts o\r\nORDER BY\r\n    o.order_date, o.client_id", "relation_name": "`takehomechallenge`.`orders_recrutement`.`order_segmentation`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T14:13:08.149944Z", "completed_at": "2024-11-18T14:13:08.181396Z"}, {"name": "execute", "started_at": "2024-11-18T14:13:08.191020Z", "completed_at": "2024-11-18T14:13:09.298206Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1627147197723389, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "takehomechallenge", "job_id": "b7241e87-cd92-4f29-a9d9-70d3f6588ad5", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.take_home_challenge.orders_2023", "compiled": true, "compiled_code": "SELECT\r\n    COUNT(*) AS total_orders_2023\r\nFROM\r\n    takehomechallenge.orders_recrutement.orders\r\nWHERE\r\n    EXTRACT(YEAR FROM date_date) = 2023", "relation_name": "`takehomechallenge`.`orders_recrutement`.`orders_2023`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T14:13:08.138430Z", "completed_at": "2024-11-18T14:13:08.153951Z"}, {"name": "execute", "started_at": "2024-11-18T14:13:08.155950Z", "completed_at": "2024-11-18T14:13:09.331836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1985907554626465, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "takehomechallenge", "job_id": "45630af5-074b-4c74-b894-e2241480bdec", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.take_home_challenge.avg_products_per_order", "compiled": true, "compiled_code": "SELECT\r\n    EXTRACT(MONTH FROM date_date) AS month,\r\n    AVG(qty) AS avg_products_per_order\r\nFROM\r\n    takehomechallenge.sales_recrutement.sales\r\nWHERE\r\n    EXTRACT(YEAR FROM date_date) = 2023\r\nGROUP BY\r\n    month\r\nORDER BY\r\n    month", "relation_name": "`takehomechallenge`.`orders_recrutement`.`avg_products_per_order`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T14:13:08.147509Z", "completed_at": "2024-11-18T14:13:08.155950Z"}, {"name": "execute", "started_at": "2024-11-18T14:13:08.188343Z", "completed_at": "2024-11-18T14:13:09.333847Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1983563899993896, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "takehomechallenge", "job_id": "646c5d65-1efd-4e74-9b81-e7205f658aaa", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.take_home_challenge.orders_2022_2023_with_qty", "compiled": true, "compiled_code": "SELECT\r\n    o.date_date AS order_date,\r\n    o.customers_id,\r\n    o.orders_id,\r\n    o.CA_ht,\r\n    SUM(s.qty) AS qty_product  -- Calcul de la quantit\u00e9 totale de produits par commande\r\nFROM\r\n    takehomechallenge.orders_recrutement.orders o\r\nJOIN\r\n    takehomechallenge.sales_recrutement.sales s\r\nON\r\n    o.customers_id = s.client_id\r\n    AND o.orders_id = s.transaction_id  -- Lier chaque commande \u00e0 ses produits\r\nWHERE\r\n    EXTRACT(YEAR FROM o.date_date) IN (2022, 2023)  -- Filtrer pour 2022 et 2023\r\nGROUP BY\r\n    o.date_date, o.customers_id, o.orders_id, o.CA_ht\r\nORDER BY\r\n    o.date_date, o.orders_id", "relation_name": "`takehomechallenge`.`orders_recrutement`.`orders_2022_2023_with_qty`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T14:13:09.340433Z", "completed_at": "2024-11-18T14:13:09.344544Z"}, {"name": "execute", "started_at": "2024-11-18T14:13:09.344544Z", "completed_at": "2024-11-18T14:13:10.324948Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.988105058670044, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "takehomechallenge", "job_id": "f8d0749f-dad4-4194-9480-0b347533511a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.take_home_challenge.orders_by_month", "compiled": true, "compiled_code": "SELECT\r\n    EXTRACT(MONTH FROM date_date) AS month,\r\n    COUNT(*) AS total_orders\r\nFROM\r\n    takehomechallenge.orders_recrutement.orders\r\nWHERE\r\n    EXTRACT(YEAR FROM date_date) = 2023\r\nGROUP BY\r\n    month\r\nORDER BY\r\n    month", "relation_name": "`takehomechallenge`.`orders_recrutement`.`orders_by_month`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T14:13:09.222302Z", "completed_at": "2024-11-18T14:13:09.224677Z"}, {"name": "execute", "started_at": "2024-11-18T14:13:09.225890Z", "completed_at": "2024-11-18T14:13:10.335480Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.114187479019165, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "takehomechallenge", "job_id": "cca62c54-8c26-41ea-96db-aeb7229b49cc", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.take_home_challenge.orders_2023_with_segmentation", "compiled": true, "compiled_code": "WITH order_counts AS (\r\n    SELECT\r\n        o.orders_id,\r\n        o.customers_id AS client_id,\r\n        o.date_date AS order_date,\r\n        o.CA_ht,  -- Assurez-vous de s\u00e9lectionner CA_ht dans la sous-requ\u00eate\r\n        COUNT(*) OVER (\r\n            PARTITION BY o.customers_id\r\n            ORDER BY o.date_date\r\n            ROWS BETWEEN 12 PRECEDING AND CURRENT ROW\r\n        ) AS orders_in_last_12_months\r\n    FROM\r\n        takehomechallenge.orders_recrutement.orders o\r\n    WHERE\r\n        EXTRACT(YEAR FROM o.date_date) = 2023\r\n)\r\nSELECT\r\n    o.orders_id,\r\n    o.client_id,\r\n    o.order_date,\r\n    o.CA_ht,\r\n    CASE\r\n        WHEN o.orders_in_last_12_months = 1 THEN 'New'\r\n        WHEN o.orders_in_last_12_months BETWEEN 2 AND 4 THEN 'Returning'\r\n        WHEN o.orders_in_last_12_months >= 5 THEN 'VIP'\r\n        ELSE 'Unknown'\r\n    END AS order_segmentation\r\nFROM\r\n    order_counts o", "relation_name": "`takehomechallenge`.`orders_recrutement`.`orders_2023_with_segmentation`"}], "elapsed_time": 3.1678385734558105, "args": {"quiet": false, "full_refresh": true, "log_level": "info", "empty": false, "use_colors": true, "invocation_command": "dbt run --full-refresh", "log_format": "default", "populate_cache": true, "static_parser": true, "printer_width": 80, "send_anonymous_usage_stats": true, "macro_debugging": false, "use_colors_file": true, "favor_state": false, "show_resource_report": false, "log_level_file": "debug", "select": [], "strict_mode": false, "log_format_file": "debug", "enable_legacy_logger": false, "log_path": "C:\\Users\\thoma\\PycharmProjects\\Take-Home challenge\\logs", "partial_parse_file_diff": true, "partial_parse": true, "indirect_selection": "eager", "print": true, "log_file_max_bytes": 10485760, "require_explicit_package_overrides_for_builtin_materializations": true, "cache_selected_only": false, "warn_error_options": {"include": [], "exclude": []}, "exclude": [], "vars": {}, "source_freshness_run_project_hooks": false, "project_dir": "C:\\Users\\thoma\\PycharmProjects\\Take-Home challenge", "version_check": true, "introspect": true, "require_resource_names_without_spaces": false, "defer": false, "profiles_dir": "C:\\Users\\thoma\\.dbt", "which": "run", "write_json": true}}